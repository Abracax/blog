<!DOCTYPE html><html lang="en"><head><title>Abracax</title><link rel="alternate" href="/atom.xml" type="application/atom.xml"><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"><link href="https://fonts.googleapis.com/css?family=Playfair+Display" rel="stylesheet"><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script><meta charset="UTF-8"><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" href="/atom.xml" title="Abracax's Notes" type="application/atom+xml">
</head><body><div class="site-header"><div class="container"><div class="site-branding"><h1 class="site-title">Abracax's Notes<a href="google.com"></a></h1><div class="site-description"><span class="site-description-text"></span></div></div></div></div><div class="menu_box"><div class="menucon"><nav class="navbar navbar-expand-lg navbar-light bg-light"><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><div class="menucon"><ul class="navbar-nav mr-auto"><li class="nav-item active"><a class="nav-link" href="/resume">About Me</a></li></ul></div><div class="menucon"><ul class="navbar-nav mr-auto"><li class="nav-item active"><a class="nav-link" href="/">Blog</a></li></ul></div><div class="menucon"><ul class="navbar-nav mr-auto"><li class="nav-item active"><a class="nav-link" target="_blank" rel="noopener" href="https://github.com/abracax">GitHub</a></li></ul></div><div class="menucon"><ul class="navbar-nav mr-auto"><li class="nav-item active"><a class="nav-link" href="/cv/">Download CV</a></li></ul></div></div></nav></div></div></body><div class="container"><div class="row"><div class="single-post"><article class="post-block"><h1 class="post-title">My OS My Choice</h1><header class="headgallery"></header><div class="row"><div class="tag-box"><div class="tags"></div></div></div><div class="post-content"><h1 id="NH3OS"><a href="#NH3OS" class="headerlink" title="NH3OS"></a>NH3OS</h1><p><strong>FIRST PLACE</strong> in Microsoft Sponsored Kernel Design Competition.</p>
<p><strong>HAPPY GRADUATION!</strong></p>
<h2 id="Baseline-Functionality"><a href="#Baseline-Functionality" class="headerlink" title="Baseline Functionality"></a>Baseline Functionality</h2><ul>
<li>PS/2 keyboard driver</li>
<li>i8259 driver</li>
<li>pit and rtc driver</li>
<li>GDT/IDT</li>
<li>Basic Exception/Trap Handlers</li>
<li>Paging</li>
<li>VGA Text-mode terminal</li>
<li>Initrd Read-only Filesystem (fake)</li>
<li>System Calls (read, write, videomap…)</li>
<li>Process Control Block</li>
<li>User level code loader and user/kernel stack switching</li>
<li>Round-robin scheduling</li>
<li>Heap (fake)</li>
</ul>
<h2 id="Extra-Functionality"><a href="#Extra-Functionality" class="headerlink" title="Extra Functionality"></a>Extra Functionality</h2><h3 id="Extra-Device-Drivers"><a href="#Extra-Device-Drivers" class="headerlink" title="Extra Device Drivers"></a>Extra Device Drivers</h3><ul>
<li>PS/2 Mouse Driver</li>
<li>PCI Driver</li>
<li>RTL8139 Driver</li>
</ul>
<h3 id="GUI"><a href="#GUI" class="headerlink" title="GUI"></a>GUI</h3><ul>
<li>Cascading windows</li>
<li>VESA high resolution display</li>
<li>Windows drag and drop using mouse</li>
<li>Basic responsive support (open close)</li>
</ul>
<h3 id="Networking-Stack"><a href="#Networking-Stack" class="headerlink" title="Networking Stack"></a>Networking Stack</h3><ul>
<li>NIC: RTL8139 Driver, ring buffer</li>
<li>Link Layer: Ethernet II support</li>
<li>Network Layer: ARP</li>
<li>Network Layer:  IPv4</li>
<li>Transport Layer: UDP</li>
<li>Transport Layer: TCP (Buggy)</li>
<li>Application Layer: DNS</li>
</ul>
<h3 id="Some-Networking-Explanation"><a href="#Some-Networking-Explanation" class="headerlink" title="Some Networking Explanation"></a>Some Networking Explanation</h3><p><img src="/2021/05/10/My-OS-my-choice/Slirp_concept.png"></p>
<ul>
<li><p>Qemu has a whole user mode network stack, it can redirect TCP and UDP protocols from qemu user to host.</p>
</li>
<li><p>Thus our OS’s NIC has IP address 10.0.2.15</p>
</li>
<li><p>We send ARP requests to get the mac address of gateway (10.0.2.2), this is placed in any IPv4 packet leaving our OS</p>
</li>
<li><p>DNS requests to 10.0.2.3:53, just send UDP requests and parse responses </p>
</li>
<li><p>Note that from inside the guest, connecting to a port on the “gateway” 10.0.2.2 will connect to that port on the host</p>
</li>
<li><p>To connect Host to Guest use TCP hostfwd when launching Qemu</p>
</li>
<li><p>Debugging:  use Wireshark and object dump to analyze packets</p>
</li>
</ul>
<h3 id="Bug-List"><a href="#Bug-List" class="headerlink" title="Bug List"></a>Bug List</h3><ul>
<li><input disabled="" type="checkbox"> GUI stability</li>
<li><input disabled="" type="checkbox"> GUI when booting eats up CPU, need GPU accelaration</li>
<li><input disabled="" type="checkbox"> TCP losing packets, “egress” unstable, no congestion control, no real sockets</li>
<li><input disabled="" type="checkbox"> Heap memory allocation bugs</li>
<li><input disabled="" type="checkbox"> Stability in whole, randomly crashes</li>
</ul>
</div></article><div class="paginator"><a class="prev" href="/2021/05/24/TiFS-PingCAP-Hackathon/">prev</a><a class="next" href="/2021/04/15/JumpTable/">next</a></div></div></div></div><div class="container-fluid"><div class="row"><div class="footer_box"><a class="col-lg-2 col-xl-2 col-md-2" href="/resume">Contact</a></div></div></div></html>